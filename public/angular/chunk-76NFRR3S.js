import{c as d,f as u}from"./chunk-TAT732FB.js";import{$ as c,ea as l,hb as p,nc as s}from"./chunk-J7P67657.js";var i=class extends Error{};i.prototype.name="InvalidTokenError";function m(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function g(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return m(e)}catch{return atob(e)}}function h(t,e){if(typeof t!="string")throw new i("Invalid token specified: must be a string");e||(e={});let r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new i(`Invalid token specified: missing part #${r+1}`);let o;try{o=g(n)}catch(a){throw new i(`Invalid token specified: invalid base64 for part #${r+1} (${a.message})`)}try{return JSON.parse(o)}catch(a){throw new i(`Invalid token specified: invalid json for part #${r+1} (${a.message})`)}}var f=class t{constructor(e){this.http=e}user_key=p("");user_data=s(()=>{let e=this.user_key();return e.length==0?{id:0,username:"",isAdmin:!1}:h(e)});loggedIn=s(()=>this.user_key().length>0);isAdmin=s(()=>this.user_data().isAdmin);baseUrl=u.baseUrl;setUserKey(e){this.user_key.set(e),localStorage.setItem("key",e)}resetUserKey(){this.user_key.set(""),localStorage.clear()}login(e){return this.http.post(this.baseUrl+"/authenticate/login",e)}register(e){return this.http.post(this.baseUrl+"/authenticate/register",e)}static \u0275fac=function(r){return new(r||t)(l(d))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};export{h as a,f as b};
