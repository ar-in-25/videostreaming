import{a as A,c as F,d as D,e as E}from"./chunk-BU5MKA3O.js";import{b as T,c as B}from"./chunk-IYLBD6AI.js";import{b as w}from"./chunk-EKQHJD4P.js";import"./chunk-HD3OWHGE.js";import{a as O}from"./chunk-5ALBM6DM.js";import{f as k}from"./chunk-XRKEJKU5.js";import"./chunk-5BHXT2IC.js";import{c as L,d as f,g as p,i as v}from"./chunk-6XXA7HXI.js";import{Ab as u,Eb as x,Hb as U,Jb as m,Rb as d,Sb as M,Ub as y,Wb as V,Ya as n,Za as c,a as g,ha as h,mb as l,ob as _,qa as C,ra as I,tb as s,y as S,yb as r,zb as a}from"./chunk-VV3OFZ4G.js";function j(i,e){i&1&&u(0,"mat-spinner")}function N(i,e){if(i&1){let t=x();r(0,"button",5),U("click",function(){C(t);let b=m(2);return I(b.subscribe())}),d(1),r(2,"mat-icon"),d(3,"add"),a()()}if(i&2){let t=m(2);n(),M(t.amISub?"Unsubscribe":"Subscribe")}}function K(i,e){if(i&1&&u(0,"app-videolist",3),i&2){let t=m(2);_("videoList",t.uploadedVideoList)("sortAllowed",!0)("latestFirst",!0)}}function R(i,e){i&1&&(r(0,"p",4),d(1,"No Videos! (\u2022\u02CB _ \u02CA\u2022)"),a())}function J(i,e){if(i&1&&(r(0,"h1",1),d(1),l(2,N,4,1,"button",2),a(),l(3,K,1,3,"app-videolist",3)(4,R,2,0,"p",4),u(5,"br")(6,"br")),i&2){let t=m();n(),y("","@","",t.user.username," videos "),n(),s(t.loggedIn()?2:-1),n(),s(t.uploadedVideoList&&t.uploadedVideoList.length>0?3:-1),n(),s(t.uploadedVideoList&&t.uploadedVideoList.length==0?4:-1)}}function Y(i,e){i&1&&(r(0,"p",0),d(1,"This user doesn't exist, young lady \u{1F64F}"),a())}var P=class i{constructor(e,t,o,b){this._userService=e;this.router=t;this._matSnackBar=o;this._authService=b}uploadedVideoList;userId;user;loggedIn;loading=!0;ngOnInit(){this.loggedIn=this._authService.loggedIn,this.router.paramMap.subscribe(e=>{this.userId=Number(e.get("UserId")),S([this._userService.getUserVideos(this.userId),this._userService.getUser(this.userId)]).subscribe({next:t=>{this.uploadedVideoList=t[0].map(o=>g({},o)),this.user=t[1],this.loggedIn()&&this.amISubscribed(),this.loading=!1}})})}getVideos(){this._userService.getUserVideos(this.userId).subscribe({next:e=>{this.uploadedVideoList=e.map(t=>g({},t))}})}subscribe(){this._userService.subscribeToUser({UserId:this.userId}).subscribe({next:e=>{this._matSnackBar.open(e.message,"OK",{duration:2e3}),this.amISub=e.message=="Subscribed"},error:e=>{this._matSnackBar.open(e.error.message,"OK",{duration:2e3})}})}getUser(){this._userService.getUser(this.userId).subscribe(e=>{this.user=e,this.loggedIn()&&this.amISubscribed()},e=>{this._matSnackBar.open(e.error.message,"OK",{duration:2e3})})}amISub;amISubscribed(){this._userService.amISubscribed(this.user.id).subscribe({next:e=>{this.amISub=e.message=="yes"}})}static \u0275fac=function(t){return new(t||i)(c(O),c(k),c(F),c(T))};static \u0275cmp=h({type:i,selectors:[["app-user"]],standalone:!0,features:[V],decls:4,vars:3,consts:[[1,"center"],[2,"color","darkgray"],["mat-stroked-button","","color","accent",2,"color","orange"],[3,"videoList","sortAllowed","latestFirst"],[2,"text-align","center","color","darkgray"],["mat-stroked-button","","color","accent",2,"color","orange",3,"click"]],template:function(t,o){t&1&&(r(0,"div"),l(1,j,1,0,"mat-spinner")(2,J,7,5)(3,Y,2,0,"p",0),a()),t&2&&(_("@slideFromTop",void 0),n(),s(o.loading?1:-1),n(),s(!o.loading&&o.user?2:!o.loading&&!o.user?3:-1))},dependencies:[w,B,A,E,D],styles:["h1[_ngcontent-%COMP%]{text-align:center;padding:8px}mat-spinner[_ngcontent-%COMP%]{margin:auto;margin-top:40vh}"],data:{animation:[L("slideFromTop",[v(":enter",[p({opacity:0}),f("500ms ease-out",p({opacity:1}))]),v(":leave",[f("300ms ease-in",p({transform:"translateY(-100%)",opacity:0}))])])]}})};export{P as UserComponent};
